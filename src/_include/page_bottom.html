@@include('../blocks/vary-modal/vary-modal.html')

<!-- TV-channels modal -->
@@include('../blocks/tvch-modal/tvch-modal.html')
<!-- Select TV-channel modal -->
@@include('../blocks/tv-select-modal/tv-select-modal.html')

<script>
  "use strict";
  /**
   * –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —è–∑—ã–∫–∞ —Å–∞–π—Ç–∞.
   * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–≤—É—Ö–±—É–∫–≤–µ–Ω–Ω—ã–π –∫–æ–¥ —è–∑—ã–∫–∞ ('ru', 'en', ...).
   *
   * @param {Object} options
   * @param {string[]} [options.supportedLangs] - –ú–∞—Å—Å–∏–≤ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —è–∑—ã–∫–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä: ['ru', 'en', 'fr']
   * @param {string} [options.defaultLang] - –Ø–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'en')
   * @returns {string} –ö–æ–¥ —è–∑—ã–∫–∞
   */
  (function(){
    window.getCurrentLang = function(options = {}) {
      const { supportedLangs = ['uk', 'ru', 'en'], defaultLang = 'uk' } = options;
      // 1. –ü–æ–ª—É—á–∞–µ–º –∏–∑ <html lang="">
      let lang = document.documentElement.lang;
      if (lang) {
        lang = lang.toLowerCase().slice(0, 2);
        if (!supportedLangs.length || supportedLangs.includes(lang)) {
          return lang;
        }
      }
      // 2. –ü–æ–ª—É—á–∞–µ–º –∏–∑ URL: /ru/, /en/, /fr/...
      const pathMatch = window.location.pathname.match(/^\/([a-z]{2})(\/|$)/i);
      if (pathMatch) {
        lang = pathMatch[1].toLowerCase();
        if (!supportedLangs.length || supportedLangs.includes(lang)) {
          return lang;
        }
      }
      // 3. –í–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —è–∑—ã–∫
      return defaultLang;
    }
  }());
</script>

<script>
  "use strict";
  (function(){
    const varyModal = document.getElementById('varyModal');

    if (varyModal) {
      varyModal.addEventListener('show.bs.modal', event => {
        const button = event.relatedTarget;

        // ‚úÖ –û–ü–†–ï–î–ï–õ–Ø–ï–ú –ö–û–ù–¢–ï–ö–°–¢: —ç—Ç–æ —Ç–∞—Ä–∏—Ñ –∏–ª–∏ –æ–±—â–∞—è —Ñ–æ—Ä–º–∞?
        const tariffCard = button ? button.closest('.tariff-card') : null;

        // –≠–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–∞–ª–∫–∏
        const modalTitle = varyModal.querySelector('.vary-modal__title');
        const modalSubtitle = varyModal.querySelector('.vary-modal__subtitle');
        const ipTariffInput = varyModal.querySelector('#ipTariff');
        const tvTariffInput = varyModal.querySelector('#tvTariff');
        const totalPriceInput = varyModal.querySelector('#totalPrice');

        // –ü–æ–ª—É—á–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏–∑ –∫–Ω–æ–ø–∫–∏
        const tariffName = button ? button.getAttribute('data-bs-whatever') : '';

        // === –°–¶–ï–ù–ê–†–ò–ô 1: –¢–ê–†–ò–§–ù–ê–Ø –ö–ê–†–¢–û–ß–ö–ê ===
        if (tariffCard) {
          console.log('üéØ –¢–∞—Ä–∏—Ñ–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π');

          // –ó–∞–≥–æ–ª–æ–≤–æ–∫
          modalTitle.textContent = tariffName || '–ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ —Ç–∞—Ä–∏—Ñ';

          // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª–µ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ç–∞—Ä–∏—Ñ–∞
          ipTariffInput.value = tariffName || '';

          // ‚úÖ –ó–ê–ü–û–õ–ù–Ø–ï–ú –¶–ï–ù–£ –∏–∑ –∫–∞—Ä—Ç–æ—á–∫–∏
          const priceElement = tariffCard.querySelector('.tariff-card__opt-item--price strong');
          if (priceElement && totalPriceInput) {
            const price = priceElement.textContent.trim();
            totalPriceInput.value = price;
            console.log('üí∞ –¶—ñ–Ω–∞:', price);
          }

          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã–±—Ä–∞–Ω –ª–∏ IPTV-–ø–∞–∫–µ—Ç
          if (tariffCard.dataset.selectedIptv) {
            // IPTV –≤—ã–±—Ä–∞–Ω
            tvTariffInput.value = tariffCard.dataset.selectedIptv;
            modalSubtitle.textContent = tariffCard.dataset.selectedIptv;
            modalSubtitle.style.display = ''; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫

            console.log('‚úÖ IPTV –∑–Ω–∞–π–¥–µ–Ω–æ:', tariffCard.dataset.selectedIptv);
          } else {
            // IPTV –Ω–µ –≤—ã–±—Ä–∞–Ω
            tvTariffInput.value = '–ë–µ–∑ IPTV';
            modalSubtitle.textContent = '';
            modalSubtitle.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫

            console.log('‚ö†Ô∏è IPTV –Ω–µ –≤–∏–±—Ä–∞–Ω–æ');
          }

          console.log('üìù –î–∞–Ω—ñ —Ñ–æ—Ä–º–∏ (—Ç–∞—Ä–∏—Ñ):', {
            —Ç–∞—Ä–∏—Ñ: ipTariffInput.value,
            iptv: tvTariffInput.value,
            —Ü—ñ–Ω–∞: totalPriceInput.value
          });
        }
        // === –°–¶–ï–ù–ê–†–ò–ô 2: –û–ë–©–ê–Ø –§–û–†–ú–ê (–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –∏ —Ç.–ø.) ===
        else {
          console.log('üìû –ó–∞–≥–∞–ª—å–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π (–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è)');

          // –ó–∞–≥–æ–ª–æ–≤–æ–∫ (–º–æ–∂–µ—Ç –±—ã—Ç—å "–ó–∞–º–æ–≤–∏—Ç–∏ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—é" –∏ —Ç.–ø.)
          modalTitle.textContent = tariffName || '–ó–∞–º–æ–≤–∏—Ç–∏ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—é';

          // ‚úÖ –û–ß–ò–©–ê–ï–ú –≤—Å–µ —Ç–∞—Ä–∏—Ñ–Ω—ã–µ –ø–æ–ª—è
          ipTariffInput.value = '';
          tvTariffInput.value = '';
          if (totalPriceInput) {
            totalPriceInput.value = '';
          }

          // –°–∫—Ä—ã–≤–∞–µ–º –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫
          modalSubtitle.textContent = '';
          modalSubtitle.style.display = 'none';

          console.log('üìù –î–∞–Ω—ñ —Ñ–æ—Ä–º–∏ (–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è): —Ç–∞—Ä–∏—Ñ–Ω—ñ –ø–æ–ª—è –æ—á–∏—â–µ–Ω—ñ');
        }
      });
    }
  }());
</script>


<!-- <script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script> -->
<script type="module" src="js/lazy-loader.js"></script>
<script src="js/lazy-lottie-init.js" defer></script>
<script src="js/lazy-maps-init.js" defer></script>
<script src="js/script.min.js" defer></script>
